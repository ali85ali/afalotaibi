import java.io.IOException;
import java.net.InetSocketAddress;
import java.net.Socket;
import java.util.ArrayList;
import java.util.List;

public class ServerStatusCheckService {

    public static boolean hostAvailabilityCheck(String host, Integer port) {

        try (Socket s = new Socket()) {
            s.connect(new InetSocketAddress(host, port), 5000);
            System.out.println("server is up");
            return true;
        } catch (IOException ex) {
            ex.printStackTrace();
            System.out.println("request to server failed!");
            /* ignore */
        }
        return false;
    }

    public static void main(String[] args) {

        List<String> sendToEmails = new ArrayList<>();
        sendToEmails.add("alfalotaibi.c@stc.com.sa");

        List<ServerInfo> servers = new ArrayList<>();
        String msg = "";

        servers.add(new ServerInfo("172.20.204.98", 7010));
        boolean flag;
        for (ServerInfo serverInfo : servers) {
            flag = hostAvailabilityCheck(serverInfo.ip, serverInfo.port);

            if (flag){
                msg="Server ("+serverInfo.getIp()+":"+serverInfo.getPort()+") is up";
            }else {
                msg="Server ("+serverInfo.getIp()+":"+serverInfo.getPort()+") is down";
            }
            EmailUtilities.sendTemplate(msg,sendToEmails);

        }
    }


}

class ServerInfo {
    String ip;
    int port;

    public ServerInfo(String ip, int port) {
        this.ip = ip;
        this.port = port;
    }

    public String getIp() {
        return ip;
    }

    public void setIp(String ip) {
        this.ip = ip;
    }

    public int getPort() {
        return port;
    }

    public void setPort(int port) {
        this.port = port;
    }
}
